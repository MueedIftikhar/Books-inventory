#include<iostream>
#include<cstring>
#include<fstream>
#include<string>
#include<conio.h>
#include<stdio.h>
#include<cstdlib>
using namespace std;
void welcome_note();
ofstream zfile,rfile;
fstream nameFile,mainFile;
ifstream inputFile,file;
int addBook();
void quit();
int viewExistingBook();
int newLogin();
void serial ();
int searchBook();
void program_str();
int main_start();
int s;
int ch;
void mainx();
int newLogin();
int existingLogin();
int reset();
int i=1,n,c;
int size=30;
char user[10];
string a,x,username,password,t,b,temp,z;
bool found=false;
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
//??????????????????????????????????????????????????????????????????????????????????????
struct Book
{
       string Name;
       int Edition;
       string Author;
       int Qty;
       float Price;
       
       }; 
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////      
main()
{
	
		cout<< "Choose Your Desired Option\n";
		cout<< "1.Start the Program\n";
		cout<< "2.Reset The Password\n";
		cin>> n;
		if(n==1)
		{
			newLogin();
		}
		else if(n==2)
		{
			reset();
		}
		else 
		{
			cout<< "Invalid Choice\n";
		}
		

}
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
//??????????????????????????????????????????????????????????????????????????????????????////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
//??????????????????????????????????????????????????????????????????????????????????????
int reset()
{
	file.open("Login.dat");
	file>> t;
      file>> b;
	char ch;
	cout<< "Want to Reset the program\n";
	cout<< "Press Y.Yes or N.No\n";
	cin>> ch;
	if (ch=='Y' || 'y')
	{
		file.open("Login.dat");
		cout<< "Enter your Current Password\n";
		do   //Loop until 'Enter' is pressed
         {
         c = getch();
         switch(c)
            {
            case 0:
               {
               break;
               }
            case '\b':
               {
               if(password.size() != 0)  //If the password string contains data, erase last character
                  {
                  cout << "\b \b";
                  password.erase(password.size() - 1, 1);
                  }
               break;       
               }   
            default:
               {
               if(isalnum(c) || ispunct(c))
                  {
                  password += c;
                  cout << "*";           
                  }
               break;     
               }      
            };
         }
      while(c != '\r');
      
      
      if(b.compare(password)==0)
      {
      	cout<< "Password Matched\n";
      	rfile.open("Login.dat");
      	cout<< "Reset Completed\n";
      }
      else if(b.compare(password)!=0)
      {
      	cout<< "Password Invalid\n";
      }
		
	}
}
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

int newLogin()
{
	file.open("Login.dat");
if (file==0 &&!found)
{
	rfile.open("Login.dat");
	getline(cin,temp);
     cout<<"Enter New User Name: ";
     getline(cin,a);
     rfile<<a<<endl;
     cout<<"Enter New password: ";
     getline(cin,x);
	 rfile<<x<<endl;
	}
	else
	{
		existingLogin();
	}
}
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

int existingLogin()
{
	if (file)
{
	
//cout<<"File found"<<endl;
file>> z;
file>> b;
if(z.length()!=0)
{

getline(cin,temp);
cout<<"Please Enter User Name\n";
getline(cin,username);
if (username.length()==0)
{
	cout<< "Username can't be spaces\n";
}
else if(username.length()!=0)
{
cout<<"Please Enter Password\n";

do   //Loop until 'Enter' is pressed
         {
         c = getch();
         switch(c)
            {
            case 0:
               {
               break;
               }
            case '\b':
               {
               if(password.size() != 0)  //If the password string contains data, erase last character
                  {
                  cout << "\b \b";
                  password.erase(password.size() - 1, 1);
                  }
               break;       
               }   
            default:
               {
               if(isalnum(c) || ispunct(c))
                  {
                  password += c;
                  cout << "*";           
                  }
               break;     
               }      
            };
         }
      while(c != '\r');
     file.open("Login.dat") ;


	if(z.compare(username)==0 && b.compare(password)==0)
	{
	cout<<"\nLogin Successfull\n";
	system("cls");
	mainx();
	
	}
	else
	{
	
	cout<< "\nPassword Not matched\n";
	}
	}
	}
	else if (z.length()==0)
	{
	newLogin();
	}


	}
	}
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
//??????????????????????????????????????????????????????????????????????????????????????
int searchBook()
{
	int index=0;
	inputFile.open("Books.txt");
Book result[index];
cin>>index;
inputFile>>result[index].Name;
cout<<"THE SEARCH IS COMPLETED\n";
cout<<result[index].Name;
}
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
//??????????????????????????????????????????????????????????????????????????????????????
int addBook()
{
	Book b[25];
	zfile.open("Books.dat", std::ios::app);
	int bookId=786000;
	int i=0;
	int x,y;
do
{
	bookId=bookId+1;
    zfile<<"Book Serial No: "<<bookId<<endl;
    cout<< "Book Serial No.: "<<bookId<<endl;
    cout<< ""<<endl;    
    cin.ignore();
	cout<<"Book Name: ";
    getline(cin,b[i].Name);
    zfile<<"Book Name: "<<b[i].Name<<endl;    
    cout<<"Edition:";
    cin>> b[i].Edition;
    zfile<<"Edition:"<<b[i].Edition<<endl;
    cin.ignore();
    cout<<"Author Name: ";
    getline(cin,b[i].Author);
    zfile<<"Author: "<< b[i].Author<<endl;
    cout<<"Quantity: ";
	cin>> b[i].Qty;
	zfile<<"Quantity: "<< b[i].Qty<<endl;
	cout<<"Price: ";
	cin>> b[i].Price;
	zfile<<"Price: "<<b[i].Price<<endl;
	
    
    
        
    cout<< "\tBook Saved Successfully\t\n";
    cout<< "\t---------------\n\n";
    cout<< "Want to add another Book\n";
    cout<< "Press 1.Yes or 2.No\n";
    cin>> ch;
    if (ch==2)
    {
              system("cls");
    	mainx();
    }
    else if (ch>2)
    {
    	cout<< "Invalid Input\n";
    	cout<< "-------------\n";
	}    
system("cls");
}while(ch==1);
system("cls");
mainx();
}
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
//??????????????????????????????????????????????????????????????????????????????????????
int viewExistingBook()
{ int i=1;
    int bookId;
    string input;
    cout<< "Enter Book ID: ";
    cin>> bookId;
inputFile.open("Books.dat");
if (inputFile)
{
	 getline(inputFile, input);
	 while (inputFile)
	 {
	 cout << input << endl;
	 getline(inputFile, input); 
}
}
else if (!inputFile)
{
	cout<< "File path not correct\n";
}
}
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
//??????????????????????????????????????????????????????????????????????????????????????
void welcomeNote()
{
	cout<< "\n\t***Welcome To Books System***\t\n";
	cout<< "\t-----------------------------\t\n";
	cout<< "\t  Choose your desired option  \t\n";
	cout<< "\t  --------------------------\n";
}
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
//??????????????????????????????????????????????????????????????????????????????????????
void mainx ()
{
	int b[size];
	
	welcomeNote();	
	int in;	
	cout<< "1. Add New Book\n";
	cout<< "2. View existing Book Records\n";
	cout<< "3. Quit the Program\n";
   cin>>in;
	if(in==1)
	{
             system ("cls");
	addBook();	
		}
		else if(in==2)
		{
             system ("cls");
			viewExistingBook();		
		}
		else if (in==3)
		{
			cout<< "GOOD BYE...!!\n";
			}
			else if (in==4)
			{
				searchBook();
				}
			else 
			{
				cout<< "Invalid Input"<<endl;
				cout<< "-------------\n";
				
				mainx();
				}
				}
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
//??????????????????????????????????????????????????????????????????????????????????????				
				

